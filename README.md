# 프로젝트
입금, 인출하는 GRPC 서버를 구현합니다. 유저마다 계좌는 여러 계좌를 가질 수 있습니다. 그리고 영속성은 파일로 관리합니다.

| 디렉토리            | 설명 |
|---------------------|-------------------------------------------------------------------------------------------------------|
| cmd/                | 메인 애플리케이션 엔트리 포인트를 포함합니다. 여러 실행 파일이 필요한 경우 여기에 추가할 수 있습니다. |
| internal/           | 외부에서 임포트할 수 없는 패키지들을 포함합니다. 프로젝트의 핵심 로직이 여기에 위치합니다.|
|internal/api/v1      | api 정의 (protobuf) |
|internal/model      | 데이터 모델 정의 |
|internal/repository | 데이터 저장 및 검색 로직    |
|internal/service    | 비즈니스 로직                    |
| pkg/                 | 외부로 공개하는 라이브러리 코드를 포함한다. |
| data/               | JSON 파일 등의 데이터 파일을 저장합니다.    |

- log, recover interceptor 추가

# 실행 방법
`make run`

# 설명
## api 정의
아래 service를 `internal/api/v1` 파일 내부에 작성을 해놓았습니다.
- 유저 생성
- 유저 업데이트
- 유저 조회
- 유저 삭제
- 로그인

- 계좌 생성
- 계좌 조회
- 계좌 업데이트
- 계좌 삭제
- 계좌 입출금 내역 조회

## api 구현

고민한 부분
- repository에서 데이터 영속성을 파일로 관리하라고 하여 쉽게 디비를 변경이 가능하도록 고수준의 인터페이스를 서비스에서 사용하도록 했습니다.
- di: di framework를 fx 등과 같이 사용하여 자동적으로 주입해줄 수 있지만, 따로 사용하지 않았습니다.
- jwt 토큰을 서버에서 만료: jwt 토큰은 서명을 통해 데이터 조작되지 않았는지 확인할 수 있기 때문에 쿠키보단 보안적으로 우수하며, 세션과 같이 유저 정보를 따로 서버에 저장할 필요가 없기 때문에 서버 리소스 측면에서도 장점이 있습니다. 하지만, jwt 토큰은 제한 시간 동안 허용해주는 토큰이라, 탈취된 토큰은 제한된 시간동안 사용이 가능하다는 단점이 있습니다. 과제의 요구사항에서는 서버에서 만료시킬 수 있어야 한다는 요구사항이 있기 때문에 서버에 유저별 토큰 만료시간을 저장하는 방식으로 강제 만료를 시킬 수 있습니다. 서버에서 체크해서 토큰을 만료시키는 것만 구현했습니다.
- 입금, 인출 동시성 처리는 accountID 별로 lock을 걸어서 처리하도록 했습니다.
